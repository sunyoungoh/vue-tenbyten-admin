(function(t){function e(e){for(var s,n,o=e[0],l=e[1],d=e[2],c=0,p=[];c<o.length;c++)n=o[c],Object.prototype.hasOwnProperty.call(a,n)&&a[n]&&p.push(a[n][0]),a[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,d||[]),r()}function r(){for(var t,e=0;e<i.length;e++){for(var r=i[e],s=!0,o=1;o<r.length;o++){var l=r[o];0!==a[l]&&(s=!1)}s&&(i.splice(e--,1),t=n(n.s=r[0]))}return t}var s={},a={app:0},i=[];function n(e){if(s[e])return s[e].exports;var r=s[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=s,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/vue-tenbyten-admin/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var d=0;d<o.length;d++)e(o[d]);var u=l;i.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},4546:function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);var s=r("2b0e"),a=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view",{attrs:{id:"main"}}),e("footer",[t._v("© 2022 SunYoungOh. All right reserved.")])],1)},i=[],n=(r("f3ad"),r("2877")),o={},l=Object(n["a"])(o,a,i,!1,null,null,null),d=l.exports,u=r("8c4f"),c=function(){var t=this,e=t._self._c;return e("section",{staticClass:"home"},[t._m(0),e("h2",[t._v("텐바이텐 어드민 주문관리")]),e("LoginForm"),t.loading?e("LoadingSpinner"):e("OrderList")],1)},p=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"logo"},[e("img",{attrs:{src:r("cf05")}})])}],m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-container"},[t.isLogin?e("div",{staticClass:"logout",on:{click:t.logout}},[t._v("로그아웃")]):t._e(),t.isLogin?e("div",{staticClass:"welcome"},[t._v(" ❤️ "),e("b",[t._v(" "+t._s(t.brandNameKor))]),t._v("님 환영합니다! ❤️ ")]):e("div",{staticClass:"login-form"},[e("div",{staticClass:"input-item"},[e("div",{staticClass:"input-wrap"},[e("label",{attrs:{for:"brandId"}},[t._v("brandId")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.brandId,expression:"brandId"}],attrs:{id:"brandId",type:"text",autocomplete:"off"},domProps:{value:t.brandId},on:{click:function(e){return t.resetError(e)},input:function(e){e.target.composing||(t.brandId=e.target.value)}}})]),e("div",[e("p",{staticClass:"error"},[t._v(t._s(t.brandIdError))])])]),e("div",{staticClass:"input-item"},[e("div",{staticClass:"input-wrap"},[e("label",{attrs:{for:"apiKey"}},[t._v("apiKey")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.apiKey,expression:"apiKey"}],attrs:{id:"apiKey",type:"password",clearable:""},domProps:{value:t.apiKey},on:{click:function(e){return t.resetError(e)},input:function(e){e.target.composing||(t.apiKey=e.target.value)}}})]),e("div",[e("p",{staticClass:"error"},[t._v(t._s(t.apiKeyError))])])])]),e("div",{staticClass:"btns_order"},[t.isLogin?[e("button",{staticClass:"btn-new-orders",on:{click:function(e){return t.getOrdersData("new-orders")}}},[t._v(" 신규 주문 조회 ")]),e("button",{staticClass:"btn-outline",on:{click:function(e){return t.getOrdersData("ready")}}},[t._v(" 배송 준비 중 조회 ")])]:e("button",{staticClass:"btn-login",attrs:{disabled:t.loading},on:{click:t.login}},[t.loading?e("span",{staticClass:"spinner"}):e("span",[t._v("로그인")])])],2)])},h=[],g={data(){return{brandId:this.$store.state.user.brandId,apiKey:this.$store.state.user.apiKey,apiKeyError:"",brandIdError:"",loading:!1}},computed:{isLogin(){return this.$store.state.user.isLogin},statusCode(){return this.$store.state.order.resultStatusCode},brandNameKor(){return this.$store.state.user.brandNameKor}},methods:{resetError(t){"apiKey"==t.currentTarget.id&&(this.apiKeyError=""),"brandId"==t.currentTarget.id&&(this.brandIdError="")},inputEmptyCheck(){this.brandId?this.brandIdError="":this.brandIdError="brandId를 입력해주세요.",this.apiKey?this.apiKeyError="":this.apiKeyError="apiKey를 입력해주세요."},async login(){this.inputEmptyCheck(),""!==this.apiKey&&""!==this.brandId&&(this.loading=!0,await this.$store.dispatch("login",{brandId:this.brandId,apiKey:this.apiKey})),this.loading=!1},async getOrdersData(t){this.isLogin&&(this.$store.commit("setClickedBtn",t),await this.$store.dispatch("getOrdersData"))},logout(){this.brandId="",this.apiKey="",this.$store.dispatch("logout")}}},f=g,b=(r("9a5f"),Object(n["a"])(f,m,h,!1,null,null,null)),v=b.exports,_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-list-container"},[t.titleInfo?e("h1",{class:t.titleInfo.css},[t._v(" "+t._s(t.titleInfo.msg)+" ")]):t._e(),e("div",{staticClass:"table-container",attrs:{id:"no-more-tables"}},[0!==t.orderListCount?e("table",[e("thead",[e("tr",[e("th",[t._v("주문일")]),e("th",[t._v("주문자ID")]),e("th",{staticClass:"orderer-name"},[t._v("주문자")]),e("th",{staticClass:"item-name"},[t._v("상품명")]),e("th",{staticClass:"item-option"},[t._v("옵션")]),e("th",[t._v("주문메모")]),"ready"==t.clickedBtn?e("th",[t._v("발송상태")]):t._e()])]),e("tbody",t._l(t.orderList,(function(t,r){return e("OrderItem",{key:r,attrs:{item:t}})})),1)]):t._e()])])},y=[],C=function(){var t=this,e=t._self._c;return e("tr",[e("td",{staticClass:"order-date",attrs:{"data-title":"주문일"}},[t._v(t._s(t.orderDate))]),e("td",{attrs:{"data-title":"주문자ID"}},[t._v(t._s(t._f("emptyValue")(t.item["UserId"])))]),e("td",{staticClass:"orderer-name",attrs:{"data-title":"주문자"}},[t._v(t._s(t.item["ordererName"]))]),e("td",{staticClass:"item-name",attrs:{"data-title":"상품명"}},[t._v(" "+t._s(t._f("itemName")(this.item["details"][0]["itemId"]))+" ")]),e("td",{staticClass:"item-option",attrs:{"data-title":"옵션"}},[t._v(t._s(t.itemOptionName))]),e("td",{attrs:{"data-title":"주문메모"}},[t._v(t._s(t._f("emptyValue")(t.itemRequireMemo)))]),"ready"==this.$store.state.order.clickedBtn?e("td",{staticClass:"btns_post",attrs:{"data-title":"발송상태"}},[t.validateEmail?["none"==t.postResult&&0==t.loading?e("button",{staticClass:"btn_post-default",on:{click:t.sendMailAndPostOrder}},[t._v(" 발송하기 ")]):t._e(),1==t.loading?e("button",{staticClass:"btn_post-loading"},[t._v(" 발송 중.. ")]):["complete"==t.postResult?e("button",{staticClass:"btn_post-complete"},[t._v(" 발송완료 ")]):"fail"==t.postResult?e("button",{staticClass:"btn_post-fail"},[t._v(" 발송실패 ")]):t._e()]]:e("button",{staticClass:"btn_post-direct"},[t._v("직접발송")])],2):t._e()])},I=[],O=r("cee4"),L=r("2f62"),K=r("0e44");const w={state:{apiKey:"",brandId:"",brandNameKor:"",isLogin:!1},mutations:{setUserData(t,e){t.apiKey=e.apiKey,t.brandId=e.brandId,t.brandNameKor=e.brandNameKor},clearUserData(t){t.apiKey="",t.brandId="",t.brandNameKor=""},setIsLogin(t,e){t.isLogin=e}},actions:{async login({commit:t},e){t("setTitleInfo",{},{root:!0}),t("clearUserData"),t("clearResultStatusCode",null,{root:!0}),t("clearOrderList",null,{root:!0});let{data:r}=await T(e.apiKey);e.brandId==r.brandid?(t("setResultStatusCode",200,{root:!0}),t("setUserData",{apiKey:e.apiKey,brandId:e.brandId,brandNameKor:r.BrandNameKor}),t("setIsLogin",!0)):(t("setResultStatusCode",401,{root:!0}),t("setTitleInfo",{css:"highlighter highlighter__red",msg:"🚨 권한이 없습니다."},{root:!0}))},logout({commit:t}){t("setIsLogin",!1),t("clearUserData"),t("clearResultStatusCode",null,{root:!0}),t("clearOrderList",null,{root:!0}),t("clearTitleInfo",null,{root:!0})}}};var S=w;const k={state:{clickedBtn:"",orderList:[],resultStatusCode:"",titleInfo:[],loading:!1},getters:{orderListCount(t){return t.orderList.length}},mutations:{setTitleInfo(t,e){t.titleInfo=e},clearTitleInfo(t){t.titleInfo=[]},setClickedBtn(t,e){t.clickedBtn=e},setOrderList(t,e){t.orderList=e},setOrderListTest(t,e){t.orderList=e},clearOrderList(t){t.orderList=[]},setResultStatusCode(t,e){t.resultStatusCode=e},clearResultStatusCode(t){t.resultStatusCode},setLoading(t,e){t.loading=e}},actions:{async getOrdersData({state:t,commit:e,dispatch:r}){e("setLoading",!0),e("clearResultStatusCode"),e("clearOrderList");let s=[];"new-orders"==t.clickedBtn?s=await M():"ready"==t.clickedBtn&&(s=await U()),console.log(s.data.outPutValue),"SUCCESS"==s.data.code?(e("setResultStatusCode",200),0!==s.data.totalCount&&e("setOrderList",s.data.outPutValue)):(console.log("error"),e("clearOrderList"),e("setResultStatusCode",s.status)),r("fetchTitleInfo"),e("setLoading",!1)},fetchTitleInfo({commit:t,state:e,getters:r}){t("clearTitleInfo");let s={};200==e.resultStatusCode?(s="new-orders"==e.clickedBtn?{clickedBtn:"신규 주문",emoji:"🥳"}:{clickedBtn:"배송 준비 중인 주문",emoji:"📦"},0!==r.orderListCount?(s.msg=`${s.clickedBtn}이 ${r.orderListCount}건 있습니다! ${s.emoji}`,s.css="highlighter highlighter__yellow"):(s.msg=s.clickedBtn+"이 없습니다 🥲 ",s.css="highlighter highlighter__grey")):(s.css="highlighter highlighter__red",404==e.statusCode?s.msg="🚨 요청이 잘못되었습니다.":s.msg=e.resultStatusCode+" 에러가 발생하였습니다."),t("setTitleInfo",s)}}};var j=k;s["a"].use(L["a"]);var D=new L["a"].Store({plugins:[Object(K["a"])({paths:["user"]})],strict:!1,modules:{user:S,order:j}});function R(t){return t.interceptors.request.use((function(t){return t.headers.Authorization="bearer "+D.state.user.apiKey,t}),(function(t){return Promise.reject(t)})),t.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)})),t}function N(){return O["a"].create({baseURL:"https://send-mail-server-sunyoungoh.koyeb.app"})}function E(){const t=O["a"].create({baseURL:"https://send-mail-server-sunyoungoh.koyeb.app"});return R(t)}const x=N(),$=E(),B=()=>{let t=new Date;t.setDate(t.getDate()-3);let e=t.getFullYear(),r=("0"+(1+t.getMonth())).slice(-2),s=("0"+t.getDate()).slice(-2);return e+"-"+r+"-"+s},P=()=>{let t=new Date,e=t.getFullYear(),r=("0"+(1+t.getMonth())).slice(-2),s=("0"+t.getDate()).slice(-2);return e+"-"+r+"-"+s},T=t=>x.get("/tenbyten/brandinfo",{headers:{Authorization:"bearer "+t}}),M=()=>$.get("/tenbyten/orders",{params:{brandId:D.state.user.brandId,startdate:B(),enddate:P()}}),U=()=>$.get("/tenbyten/orders/orderhistory",{params:{brandId:D.state.user.brandId,startdate:B(),enddate:P()}}),q=(t,e)=>$.post("/tenbyten/orders/orderconfirm",{orderSerial:t,detailIdx:e,songjangDiv:"97",songjangNo:"0"}),A=t=>x.post("/mail",t);var V={props:{item:{type:Object}},data(){return{postResult:"none",loading:!1}},computed:{validateEmail(){const t=/.+@.+\..+/;return t.test(this.item["details"][0]["RequireMemo"])},orderDate(){let t=this.item["orderDate"].split("-");return t[0].substr(2)+"/"+t[1]+"/"+t[2]},itemOptionName(){let t=this.item["details"][0]["itemOptionName"];if(""!==t){let e=this.item["details"][0]["itemOptionName"].indexOf("꼭");-1!==e&&(t=this.item["details"][0]["itemOptionName"].substring(0,e-1))}return t},itemRequireMemo(){return this.item["details"][0]["RequireMemo"].trim()}},methods:{async postOrder(){const{data:t}=await q(this.item["OrderSerial"],this.item["details"][0]["DetailIdx"]);"SUCCESS"==t.code?(this.loading=!1,this.postResult="complete"):this.postResult="fail"},async sendMailAndPostOrder(){let t={};if(this.loading=!0,this.validateEmail){var e;try{t=await A({store:"텐바이텐/영로그",items:[{itemId:this.item["details"][0]["itemId"],itemOptionName:this.itemOptionName}],toEmail:this.item["details"][0]["RequireMemo"]}),console.log("메일 전송 완료")}catch(r){console.log(r),this.loading=!1,400==r.response.status&&(this.postResult="fail")}200==(null===(e=t)||void 0===e?void 0:e.status)&&this.postOrder()}else this.postOrder()}},filters:{emptyValue(t){return t||"X"},itemName(t){switch(t){case 5033569:return"2023 심플 플래너";case 5033568:return"2023 모던 플래너";case 5033567:return"2023 타임라인 플래너";case 5033566:return"2023 먼슬리&데일리 플래너";case 5033565:return"31DAYS 플래너";case 5033562:return"3년 5년 다이어리";case 5033564:return"세로형 인덱스 노트";case 5033563:return"가로형 인덱스 노트";case 5033560:return"독서노트";case 5033558:return"드라마노트";case 5033557:return"먼슬리 트래커북";case 5033561:return"180 베이직 노트";case 5033559:return"180 체커보드 노트";case 5068583:return"레시피북";default:return""}}}},F=V,Y=Object(n["a"])(F,C,I,!1,null,null,null),z=Y.exports,J={components:{OrderItem:z},computed:{orderList(){return this.$store.state.order.orderList},orderListCount(){return this.$store.getters.orderListCount},clickedBtn(){return this.$store.state.order.clickedBtn},titleInfo(){return this.$store.state.order.titleInfo}}},H=J,X=Object(n["a"])(H,_,y,!1,null,null,null),G=X.exports,Q=function(){var t=this;t._self._c;return t._m(0)},W=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"loading"},[e("div",{staticClass:"loading__inner"},[e("div",{staticClass:"loading__content"},[e("span",{staticClass:"spinner"})])])])}],Z={},tt=Z,et=(r("e294"),Object(n["a"])(tt,Q,W,!1,null,"2af1ac9b",null)),rt=et.exports,st={components:{LoginForm:v,OrderList:G,LoadingSpinner:rt},computed:{loading(){return this.$store.state.order.loading}}},at=st,it=Object(n["a"])(at,c,p,!1,null,null,null),nt=it.exports;s["a"].use(u["a"]);const ot=[{path:"/",name:"Home",component:nt}],lt=new u["a"]({mode:"history",base:"/vue-tenbyten-admin/",routes:ot});var dt=lt;s["a"].config.productionTip=!1,new s["a"]({router:dt,store:D,render:t=>t(d)}).$mount("#app")},"9a5f":function(t,e,r){"use strict";r("a80c")},a80c:function(t,e,r){},bd23:function(t,e,r){},cf05:function(t,e,r){t.exports=r.p+"img/logo.26500fe9.png"},e294:function(t,e,r){"use strict";r("bd23")},f3ad:function(t,e,r){"use strict";r("4546")}});
//# sourceMappingURL=app.fb812443.js.map